
% This LaTeX was auto-generated from MATLAB code.
% To make changes, update the MATLAB code and republish this document.

\documentclass{standalone}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{textcomp}
\usepackage[framed, numbered]{matlab-prettifier}

\sloppy
\definecolor{lightgray}{gray}{0.5}
\setlength{\parindent}{0pt}

\begin{document}

    
    \begin{par}
Tunes kernel hyperparameters of GPR model. Dismiss tuning for each kernel parameter by setting corresponding bounds to equal values.
\end{par} \vspace{1em}


{\textbf{Syntax}}

\begin{lstlisting}[style=Matlab-editor, basicstyle=\ttfamily\scriptsize]
Mdl = tuneKernel(Mdl, verbose)
\end{lstlisting}


{\textbf{Description}}

\begin{par}
\textbf{Mdl = tuneKernel(Mdl, verbose)} solves the negative marginal logarithmic likelihood criteria with fmincon solver.
\end{par} \vspace{1em}


{\textbf{Input Argurments}}

\begin{par}
\textbf{Mdl} model struct.
\end{par} \vspace{1em}
\begin{par}
\textbf{verbose} activates prompt for true or 1. Vice versa for false or 0.
\end{par} \vspace{1em}


{\textbf{Output Argurments}}

\begin{par}
\textbf{Mdl} optimized hyperparameters and resulting regression model.
\end{par} \vspace{1em}


{\textbf{Requirements}}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Other m-files required: None
   \item Subfunctions: fmincon, optimoptions, computeTuneCriteria,   initKernelParameters
   \item MAT-files required: None
\end{itemize}


{\textbf{See Also}}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item \begin{verbatim}fmincon\end{verbatim}
   \item \begin{verbatim}optimoptions\end{verbatim}
   \item \begin{verbatim}computeTuneCriteria\end{verbatim}
   \item \begin{verbatim}initKernelParameters\end{verbatim}
\end{itemize}
\begin{par}
Created on March 03. 2021 by Tobias Wulf. Copyright Tobias Wulf 2021.
\end{par} \vspace{1em}
\begin{par}

\end{par} \vspace{1em}
\begin{lstlisting}[style=Matlab-editor, basicstyle=\ttfamily\scriptsize]
function Mdl = tuneKernel(Mdl, verbose)

    % define options for minimum search
    options = optimoptions('fmincon', 'Display', 'off', 'Algorithm', 'sqp', ...
        'PlotFcn', {@optimplotx, @optimplotfval});

    % display tuning
    if verbose, options.Display = 'iter'; end

    % setup problem for minimum solver use problem structure to feed fmincon
    problem.solver = 'fmincon';
    problem.options = options;

    % apply bounds to prevent overfitting
    problem.lb = [Mdl.s2fBounds(1) Mdl.slBounds(1)];
    problem.ub = [Mdl.s2fBounds(2) Mdl.slBounds(2)];

    % set sl start value
    problem.x0 = Mdl.theta;

    % apply objective function and start values
    problem.objective = @(x) computeTuneCriteria(x, Mdl);

    % solve problem
    [Mdl.theta] = fmincon(problem);


    % reinit kernel with tuned parameters
    Mdl = initKernelParameters(Mdl);
end
\end{lstlisting}



\end{document}

