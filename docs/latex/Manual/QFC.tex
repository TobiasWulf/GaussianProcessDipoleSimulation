
% This LaTeX was auto-generated from MATLAB code.
% To make changes, update the MATLAB code and republish this document.

\documentclass{standalone}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{textcomp}
\usepackage[framed, numbered]{matlab-prettifier}

\sloppy
\definecolor{lightgray}{gray}{0.5}
\setlength{\parindent}{0pt}

\begin{document}

    
    
\section*{QFC}

\begin{par}
Quadratic Fractional Covariance function. Computes covariance matrix K. Works with raw matrix data. Precise solution.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Description
   \item Input Argurments
   \item Output Argurments
   \item Requirements
   \item See Also
\end{itemize}


\subsection*{Syntax}

\begin{lstlisting}[style=Matlab-editor]
K = QFC(Ax, Bx, Ay, By, theta)
\end{lstlisting}


\subsection*{Description}

\begin{par}
\textbf{K = QFC(Ax, Bx, Ay, By, theta)} computes quadratic distances bewtween data points and parametrize it with height and length scales. Computes distance with quadratic Frobenius Norm.
\end{par} \vspace{1em}


\subsection*{Input Argurments}

\begin{par}
\textbf{Ax} matrix of cosine simulation components.
\end{par} \vspace{1em}
\begin{par}
\textbf{Bx} matrix of cosine simulation components.
\end{par} \vspace{1em}
\begin{par}
\textbf{Ay} matrix of sine simulation components.
\end{par} \vspace{1em}
\begin{par}
\textbf{By} matrix of sine simulation components.
\end{par} \vspace{1em}
\begin{par}
\textbf{theta} vector of kernel parameters.
\end{par} \vspace{1em}


\subsection*{Output Argurments}

\begin{par}
\textbf{K} noise free covarianc matrix.
\end{par} \vspace{1em}


\subsection*{Requirements}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Other m-files required: None
   \item Subfunctions: sum
   \item MAT-files required: None
\end{itemize}


\subsection*{See Also}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item \begin{verbatim}initQFC\end{verbatim}
   \item \begin{verbatim}meanPolyQFC\end{verbatim}
\end{itemize}
\begin{par}
Created on November 06. 2019 by Klaus Juenemann. Copyright Klaus Juenemann 2019.
\end{par} \vspace{1em}
\begin{par}

\end{par} \vspace{1em}
\begin{lstlisting}[style=Matlab-editor]
function K = QFC(Ax, Bx, Ay, By, theta)
    arguments
        % validate data as real matrices of same size in 1st and 2nd dimension
        Ax (:,:,:) double {mustBeReal}
        Bx (:,:,:) double {mustBeReal, mustBeFitSize(Ax,Bx)}
        Ay (:,:,:) double {mustBeReal, mustBeFitSize(Ax,Ay)}
        By (:,:,:) double {mustBeReal, mustBeFitSize(Ax,By)}
        % validate kernel parameters as 1x2 vector
        theta (1,2) double {mustBeReal}
    end

    % get number of observations for each dataset, cosine and sine matrices have
    % equal sizes just extract size from one
    [~, ~, M] = size(Ax);
    [~, ~, N] = size(Bx);

    % expand covariance parameters, variance and lengthscale
    c2 = 2 * theta(2)^2; % 2*sl^2
    c1 = theta(1) * c2;   % s2f * c

    % allocate memory for K
    K = zeros(M, N);

    % loop through observation points and compute the covariance for each
    % observation against another
    for m = 1:M
        for n = 1:N
            % get distance between m-th and n-th observation
            distCos = Ax(:,:,m) - Bx(:,:,n);
            distSin = Ay(:,:,m) - By(:,:,n);

            % compute quadratic frobenius norm distance as separated
            % distances of cosine and sine, norm of vector fields
            r2 = sum(distCos .^ 2 , 'all') + sum(distSin .^ 2 , 'all');

            % engage lengthscale and variance on distance
            K(m,n) = c1 / (c2 + r2);
        end
    end
end

function mustBeFitSize(A, B)
    % Test for equal size
    if ~isequal(size(A,1,2), size(B,1,2))
        eid = 'Size:notEqual';
        msg = 'Sizes of  are not fitting.';
        throwAsCaller(MException(eid,msg))
    end
end
\end{lstlisting}



\end{document}

