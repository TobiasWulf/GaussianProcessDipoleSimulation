
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: {extensions: ["mhchem.js"]},
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            CommonHTML: {minScaleAdjust: 110,},
            "HTML-CSS": {
                availableFonts: ["TeX"],
                scale: 110
            }
        });
        MathJax.Hub.Queue(["Rerender", MathJax.Hub], function () {window.status="finished"});
    </script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>exportPublishedToPdf</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-04-27"><meta name="DC.source" content="exportPublishedToPdf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>exportPublishedToPdf</h1><!--introduction--><p>Export Matlab generated Tex documentation (publish) to combined LaTeX index file ready compile to appendix manual. LaTeX outcome is included with scriptsize fontsize. So section fonts are set to small and footnotesize in style sheet to fit overall fontsizes.</p><!--/introduction--><h2 id="1">Requirements</h2><div><ul><li>Other m-files None</li><li>Subfunctions: removeFilesFromDir</li><li>MAT-files required: data/config.mat</li></ul></div><h2 id="2">See Also</h2><div><ul><li><a href="generateConfigMat.html">generateConfigMat</a></li><li><a href="publishProjectFilesToHTML.html">publishProjectFilesToHTML</a></li><li><a href="Documentation_Workflow.html">Documentation Workflow</a></li></ul></div><p>Created on December 10. 2020 by Tobias Wulf. Copyright Tobias Wulf 2020.</p><p>
<!--
Hidden Clutter.
Edited on April 16. 2021 by Editor: Solve export via own latex style sheet.
-->
</p><h2 id="3">Start Exporting Script, Clean Up and Load Config</h2><p>At first clean up junk from workspace and clear prompt for new output. Set project root path to create absolute file path with fullfile function. Load absolute path variables and publishing options from config.mat</p><pre class="codeinput">disp(<span class="string">'Workspace cleaned up ...'</span>);
clearvars;
clc;
disp(<span class="string">'Load configuration ...'</span>);
<span class="keyword">try</span>
    load(<span class="string">'config.mat'</span>, <span class="string">'PathVariables'</span>);
<span class="keyword">catch</span> ME
    rethrow(ME);
<span class="keyword">end</span>
</pre><h2 id="4">Define Manual TOC</h2><p>The maual toc must be in the same order as in helptoc.xml in the publish html folder. The toc is used to generate a latex file to include for appendices.</p><pre class="codeinput">toc = [<span class="string">"section"</span>,           <span class="string">"GaussianProcessDipoleSimulation.tex"</span>;
       <span class="string">"section"</span>            <span class="string">"Workflows.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"Project_Preparation.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"Project_Structure.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"Git_Feature_Branch_Workflow.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"Documentation_Workflow.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"Simulation_Workflow.tex"</span>;
       <span class="string">"section"</span>,           <span class="string">"Executable_Scripts.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"publishProjectFilesToHTML.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"generateConfigMat.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"generateSimulationDatasets.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"deleteSimulationDatasets.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"deleteSimulationPlots.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"exportPublishedToPdf.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"demoGPRModule.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"investigateKernelParameters.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"compareGPRKernels.tex"</span>;
       <span class="string">"section"</span>,           <span class="string">"Source_Code.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"sensorArraySimulation.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"rotate3DVector.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"generateDipoleRotationMoments.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"generateSensorArraySquareGrid.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"computeDipoleH0Norm.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"computeDipoleHField.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"simulateDipoleSquareSensorArray.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"gaussianProcessRegression.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"initGPR.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"initGPROptions.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"initTrainDS.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"initKernel.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"initKernelParameters.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"tuneKernel.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"computeTuneCriteria.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"predFrame.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"predDS.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"lossDS.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"optimGPR.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"computeOptimCriteria.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"kernelQFCAPX.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"QFCAPX.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"meanPolyQFCAPX.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"initQFCAPX.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"kernelQFC.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"QFC.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"meanPolyQFC.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"initQFC.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"basicMathFunctions.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"sinoids2angles.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"angles2sinoids.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"decomposeChol.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"frobeniusNorm.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"computeInverseMatrixProduct.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"computeTransposeInverseProduct.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"addNoise2Covariance.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"computeAlphaWeights.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"computeStdLogLoss.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"computeLogLikelihood.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"estimateBeta.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"util.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"removeFilesFromDir.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"publishFilesFromDir.tex"</span>;
       <span class="string">"subsubsection"</span>,     <span class="string">"plotFunctions.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotTDKCharDataset.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotTDKCharField.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotTDKTransferCurves.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotKMZ60CharDataset.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotKMZ60CharField.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotKMZ60TransferCurves.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotDipoleMagnet.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotSimulationDataset.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotSingleSimulationAngle.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotSimulationSubset.tex"</span>;
       <span class="string">"paragraph"</span>,         <span class="string">"plotSimulationCosSinStats.tex"</span>
       <span class="string">"paragraph"</span>,         <span class="string">"plotSimulationDatasetCircle.tex"</span>;
       <span class="string">"section"</span>,           <span class="string">"Datasets.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"TDK_TAS2141_Characterization.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"NXP_KMZ60_Characterization.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"Config_Mat.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"Training_and_Test_Datasets.tex"</span>;
       <span class="string">"section"</span>,           <span class="string">"Unit_Tests.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"runTests.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"removeFilesFromDirTest.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"rotate3DVectorTest.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"generateDipoleRotationMomentsTest.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"generateSensorArraySquareGridTest.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"computeDipoleH0NormTest.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"computeDipoleHFieldTest.tex"</span>;
       <span class="string">"subsection"</span>,        <span class="string">"tiltRotationTest.tex"</span>;];

nToc = length(toc);
fprintf(<span class="string">"%d toc entries remarked ...\n"</span>, nToc);
</pre><h2 id="5">Scan for Tex Files</h2><p>Scan for all published Tex files in the project publish directory.</p><pre class="codeinput">disp(<span class="string">'Scan for published files ...'</span>);
TEX = dir(fullfile(PathVariables.publishHtmlPath, <span class="string">'*.tex'</span>));
<span class="keyword">if</span> nToc ~= length(TEX)
    warning(<span class="keyword">...</span>
        <span class="string">'TOC (%d) length and found Tex (%d) files are diverging.'</span>, <span class="keyword">...</span>
        nToc, length(TEX));
<span class="keyword">end</span>
</pre><h2 id="6">Export Tex</h2><p>Export found Tex files to Manual file. Each file gets its own represenstation. Filename is kept. Write files into Manual folder under LaTeX subdirectory in docs path. Get filename, move to new path. Write Manual.</p><pre class="codeinput">disp(<span class="string">'Export published Tex to Manual ...'</span>);
fprintf(<span class="string">'Source: %s\n'</span>, TEX(1).folder);
fprintf(<span class="string">'Destination: %s\n'</span>, PathVariables.exportPublishPath);
<span class="keyword">for</span> ftex = TEX'
    disp(ftex.name);
    sourcePath = fullfile(ftex.folder, ftex.name);
    destinationPath = fullfile(<span class="keyword">...</span>
        PathVariables.exportPublishPath, ftex.name);
    <span class="keyword">try</span>
        [status, msg] = movefile(sourcePath, destinationPath);
        <span class="comment">% disp(cmdout);</span>
        <span class="keyword">if</span> status ~= 1
            error(<span class="string">'Export failure.'</span>);
        <span class="keyword">end</span>
    <span class="keyword">catch</span> ME
        disp(msg);
        rethrow(ME)
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><h2 id="7">Write TOC to LaTeX File</h2><p>Wirete TOC to LaTeX file and generate for each file a subimport along toc content line with marked toc depth.</p><pre class="codeinput">disp(<span class="string">'Write TOC to Manual.tex ...'</span>);
fileID = fopen(fullfile(<span class="keyword">...</span>
    PathVariables.exportPublishPath, <span class="string">'Manual.tex'</span>), <span class="string">'w'</span>);
fprintf(fileID, <span class="string">"%% appendix software documentation\n"</span>);
fprintf(fileID, <span class="string">"%% @author Tobias Wulf\n"</span>);
fprintf(fileID, <span class="keyword">...</span>
    <span class="string">"%% Autogenerated LaTeX file. Generated by exportPublishedToPdf.\n"</span>);
fprintf(fileID, <span class="keyword">...</span>
    <span class="string">"%% Software manual with TOC generated in the same script.\n"</span>);
fprintf(fileID, <span class="string">"%% Generated on %s.\n\n"</span>, datestr(datetime(<span class="string">'now'</span>)));
fprintf(fileID, <span class="string">"\\documentclass[class=article, crop=false]{standalone}\n"</span>);
fprintf(fileID, <span class="string">"\\usepackage[subpreambles=true]{standalone}\n"</span>);
fprintf(fileID, <span class="string">"\\usepackage{import}\n\n"</span>);
fprintf(fileID, <span class="string">"\\begin{document}\n"</span>);
fprintf(fileID, <span class="string">"\\clearpage\n"</span>);
fprintf(fileID, <span class="keyword">...</span>
    <span class="string">"\\textbf{Matlab software appendix auto generated on %s.}\n\n"</span>, <span class="keyword">...</span>
    datestr(datetime(<span class="string">'now'</span>, <span class="string">'Format'</span>, <span class="string">'y-MM-d'</span>)));

<span class="keyword">for</span> i = 1:nToc
    level = toc(i);
    fName = toc(i,2);
    [~, fstr, ~] = fileparts(fName);
    lstr = lower(strrep(fstr, <span class="string">'_'</span>, <span class="string">'-'</span>));
    tstr = strrep(fstr, <span class="string">'_'</span>, <span class="string">' '</span>);

    fprintf(fileID, <span class="string">"\\%s{%s}"</span>, level, tstr);
    fprintf(fileID, <span class="string">"\\label{mcode:%s}\n"</span>, lstr);
    fprintf(fileID, <span class="string">"\\subimport{./}{%s}\n"</span>, fName);
    fprintf(fileID, <span class="string">"\\clearpage\n"</span>);
<span class="keyword">end</span>

fprintf(fileID, <span class="string">"\\end{document}\n"</span>);
fclose(fileID);
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% exportPublishedToPdf
% Export Matlab generated Tex documentation (publish) to combined LaTeX index
% file ready compile to appendix manual. LaTeX outcome is included with
% scriptsize fontsize. So section fonts are set to small and footnotesize in
% style sheet to fit overall fontsizes.
%
%
%% Requirements
% * Other m-files None
% * Subfunctions: removeFilesFromDir
% * MAT-files required: data/config.mat
%
%
%% See Also
% * <generateConfigMat.html generateConfigMat>
% * <publishProjectFilesToHTML.html publishProjectFilesToHTML>
% * <Documentation_Workflow.html Documentation Workflow>
%
%
% Created on December 10. 2020 by Tobias Wulf. Copyright Tobias Wulf 2020.
%
% <html>
% <!REPLACE_WITH_DASH_DASH
% Hidden Clutter.
% Edited on April 16. 2021 by Editor: Solve export via own latex style sheet.
% REPLACE_WITH_DASH_DASH>
% </html>
%
%
%% Start Exporting Script, Clean Up and Load Config
% At first clean up junk from workspace and clear prompt for new output. Set
% project root path to create absolute file path with fullfile function.
% Load absolute path variables and publishing options from config.mat
disp('Workspace cleaned up ...');
clearvars;
clc;
disp('Load configuration ...');
try
    load('config.mat', 'PathVariables');
catch ME
    rethrow(ME);
end

%% Define Manual TOC
% The maual toc must be in the same order as in helptoc.xml in the publish html
% folder. The toc is used to generate a latex file to include for appendices.
toc = ["section",           "GaussianProcessDipoleSimulation.tex";
       "section"            "Workflows.tex";
       "subsection",        "Project_Preparation.tex";
       "subsection",        "Project_Structure.tex";
       "subsection",        "Git_Feature_Branch_Workflow.tex";
       "subsection",        "Documentation_Workflow.tex";
       "subsection",        "Simulation_Workflow.tex";
       "section",           "Executable_Scripts.tex";
       "subsection",        "publishProjectFilesToHTML.tex";
       "subsection",        "generateConfigMat.tex";
       "subsection",        "generateSimulationDatasets.tex";
       "subsection",        "deleteSimulationDatasets.tex";
       "subsection",        "deleteSimulationPlots.tex";
       "subsection",        "exportPublishedToPdf.tex";
       "subsection",        "demoGPRModule.tex";
       "subsection",        "investigateKernelParameters.tex";
       "subsection",        "compareGPRKernels.tex";
       "section",           "Source_Code.tex";
       "subsection",        "sensorArraySimulation.tex";
       "subsubsection",     "rotate3DVector.tex";
       "subsubsection",     "generateDipoleRotationMoments.tex";
       "subsubsection",     "generateSensorArraySquareGrid.tex";
       "subsubsection",     "computeDipoleH0Norm.tex";
       "subsubsection",     "computeDipoleHField.tex";
       "subsubsection",     "simulateDipoleSquareSensorArray.tex";
       "subsection",        "gaussianProcessRegression.tex";
       "subsubsection",     "initGPR.tex";
       "subsubsection",     "initGPROptions.tex";
       "subsubsection",     "initTrainDS.tex";
       "subsubsection",     "initKernel.tex";
       "subsubsection",     "initKernelParameters.tex";
       "subsubsection",     "tuneKernel.tex";
       "subsubsection",     "computeTuneCriteria.tex";
       "subsubsection",     "predFrame.tex";
       "subsubsection",     "predDS.tex";
       "subsubsection",     "lossDS.tex";
       "subsubsection",     "optimGPR.tex";
       "subsubsection",     "computeOptimCriteria.tex";
       "subsubsection",     "kernelQFCAPX.tex";
       "paragraph",         "QFCAPX.tex";
       "paragraph",         "meanPolyQFCAPX.tex";
       "paragraph",         "initQFCAPX.tex";
       "subsubsection",     "kernelQFC.tex";
       "paragraph",         "QFC.tex";
       "paragraph",         "meanPolyQFC.tex";
       "paragraph",         "initQFC.tex";
       "subsubsection",     "basicMathFunctions.tex";
       "paragraph",         "sinoids2angles.tex";
       "paragraph",         "angles2sinoids.tex";
       "paragraph",         "decomposeChol.tex";
       "paragraph",         "frobeniusNorm.tex";
       "paragraph",         "computeInverseMatrixProduct.tex";
       "paragraph",         "computeTransposeInverseProduct.tex";
       "paragraph",         "addNoise2Covariance.tex";
       "paragraph",         "computeAlphaWeights.tex";
       "paragraph",         "computeStdLogLoss.tex";
       "paragraph",         "computeLogLikelihood.tex";
       "paragraph",         "estimateBeta.tex";
       "subsection",        "util.tex";
       "subsubsection",     "removeFilesFromDir.tex";
       "subsubsection",     "publishFilesFromDir.tex";
       "subsubsection",     "plotFunctions.tex";
       "paragraph",         "plotTDKCharDataset.tex";
       "paragraph",         "plotTDKCharField.tex";
       "paragraph",         "plotTDKTransferCurves.tex";
       "paragraph",         "plotKMZ60CharDataset.tex";
       "paragraph",         "plotKMZ60CharField.tex";
       "paragraph",         "plotKMZ60TransferCurves.tex";
       "paragraph",         "plotDipoleMagnet.tex";
       "paragraph",         "plotSimulationDataset.tex";
       "paragraph",         "plotSingleSimulationAngle.tex";
       "paragraph",         "plotSimulationSubset.tex";
       "paragraph",         "plotSimulationCosSinStats.tex"
       "paragraph",         "plotSimulationDatasetCircle.tex";
       "section",           "Datasets.tex";
       "subsection",        "TDK_TAS2141_Characterization.tex";
       "subsection",        "NXP_KMZ60_Characterization.tex";
       "subsection",        "Config_Mat.tex";
       "subsection",        "Training_and_Test_Datasets.tex";
       "section",           "Unit_Tests.tex";
       "subsection",        "runTests.tex";
       "subsection",        "removeFilesFromDirTest.tex";
       "subsection",        "rotate3DVectorTest.tex";
       "subsection",        "generateDipoleRotationMomentsTest.tex";
       "subsection",        "generateSensorArraySquareGridTest.tex";
       "subsection",        "computeDipoleH0NormTest.tex";
       "subsection",        "computeDipoleHFieldTest.tex";
       "subsection",        "tiltRotationTest.tex";];

nToc = length(toc);
fprintf("%d toc entries remarked ...\n", nToc);


%% Scan for Tex Files
% Scan for all published Tex files in the project publish directory.
disp('Scan for published files ...');
TEX = dir(fullfile(PathVariables.publishHtmlPath, '*.tex'));
if nToc ~= length(TEX)
    warning(...
        'TOC (%d) length and found Tex (%d) files are diverging.', ...
        nToc, length(TEX));
end

%% Export Tex
% Export found Tex files to Manual file. Each file gets its own represenstation.
% Filename is kept. Write files into Manual folder under LaTeX subdirectory 
% in docs path. Get filename, move to new path. Write Manual.
disp('Export published Tex to Manual ...');
fprintf('Source: %s\n', TEX(1).folder);
fprintf('Destination: %s\n', PathVariables.exportPublishPath);
for ftex = TEX'
    disp(ftex.name);
    sourcePath = fullfile(ftex.folder, ftex.name);
    destinationPath = fullfile(...
        PathVariables.exportPublishPath, ftex.name);
    try
        [status, msg] = movefile(sourcePath, destinationPath);
        % disp(cmdout);
        if status ~= 1
            error('Export failure.');
        end
    catch ME
        disp(msg);
        rethrow(ME)
    end
end


%% Write TOC to LaTeX File
% Wirete TOC to LaTeX file and generate for each file a subimport along toc
% content line with marked toc depth.
disp('Write TOC to Manual.tex ...');
fileID = fopen(fullfile(...
    PathVariables.exportPublishPath, 'Manual.tex'), 'w');
fprintf(fileID, "%% appendix software documentation\n");
fprintf(fileID, "%% @author Tobias Wulf\n");
fprintf(fileID, ...
    "%% Autogenerated LaTeX file. Generated by exportPublishedToPdf.\n");
fprintf(fileID, ...
    "%% Software manual with TOC generated in the same script.\n");
fprintf(fileID, "%% Generated on %s.\n\n", datestr(datetime('now')));
fprintf(fileID, "\\documentclass[class=article, crop=false]{standalone}\n");
fprintf(fileID, "\\usepackage[subpreambles=true]{standalone}\n");
fprintf(fileID, "\\usepackage{import}\n\n");
fprintf(fileID, "\\begin{document}\n");
fprintf(fileID, "\\clearpage\n");
fprintf(fileID, ...
    "\\textbf{Matlab software appendix auto generated on %s.}\n\n", ...
    datestr(datetime('now', 'Format', 'y-MM-d')));

for i = 1:nToc
    level = toc(i);
    fName = toc(i,2);
    [~, fstr, ~] = fileparts(fName);
    lstr = lower(strrep(fstr, '_', '-'));
    tstr = strrep(fstr, '_', ' ');
    
    fprintf(fileID, "\\%s{%s}", level, tstr);
    fprintf(fileID, "\\label{mcode:%s}\n", lstr);
    fprintf(fileID, "\\subimport{./}{%s}\n", fName);
    fprintf(fileID, "\\clearpage\n");
end

fprintf(fileID, "\\end{document}\n");
fclose(fileID);

##### SOURCE END #####
--></body></html>